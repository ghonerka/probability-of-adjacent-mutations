"0","library(parallel)"
"0","library(ggplot2)"
"0",""
"0","# Next Mutation is Adjacent -----------------------------------------------"
"0",""
"0","n <- 105"
"0","k_vals <- 0:104"
"0",""
"0","# Estimate adjacency probability by simulations"
"0","cl <- makeCluster(detectCores() - 1)"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 9 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 8 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 7 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 6 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 5 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 4 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"2","Warning in .Internal(sys.function(which)) :"
"2","
 "
"2"," closing unused connection 3 (<-HD7910FST441512.AD.UCSD.EDU:11335)
"
"0","next_adj_prob_sim <- parSapply("
"0","  cl = cl, "
"0","  X = k_vals,"
"0","  FUN = next_adj_prob, "
"0","  n = n,"
"0","  G = 1e1"
"0","  )"
"0","stopCluster(cl)"
"0",""
"0","# Estimate adjacency probability by heuristic rule"
"0","next_adj_prob_heur <- pmin(2*k_vals/(n - k_vals), 1)"
"0",""
"0","# Combine data and plot"
"0","adj_prob_data <- tibble("
"0","  k = rep(k_vals, 2),"
"0","  k_pct = k/n*100,"
"0","  probability = c(next_adj_prob_sim, next_adj_prob_heur),"
"0","  type = rep(c(""Simulation"", ""Heuristic""), each = length(k_vals))"
"0",")"
"0",""
"0","ggplot(adj_prob_data, aes(k_pct, probability, color = type)) +"
"0","  geom_point() +"
"0","  geom_line() +"
"0","  xlab(""% Mutated"") +"
"0","  ylab(""Probability that next mutation is adjacent"") +"
"0","  ggtitle(paste(""n ="", n))"
